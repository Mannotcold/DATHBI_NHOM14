USE master
GO
CREATE DATABASE TH_Metadata
GO
USE TH_Metadata
GO

CREATE TABLE DATA_FLOW (
	ID INT NOT NULL IDENTITY(1, 1),
	TABLE_NAME VARCHAR(30) NULL,
	LSET DATETIME NULL, -- ghi time cap nhat cuoi cung
	CET	DATETIME NULL, -- lay time hien tai
)
GO

/*CREATE TRIGGER INSERT_DATAFLOW ON DATA_FLOW AFTER INSERT AS
BEGIN
	UPDATE DATA_FLOW
	SET LSET = GETDATE(), CET = GETDATE()
	WHERE ID IN (SELECT DISTINCT ID FROM INSERTED)
END
GO

--INSERT DATA
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Orders', NULL, NULL);
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Products', NULL, NULL);
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Returns', NULL, NULL);
GO*/

USE TH_Metadata
GO

TRUNCATE TABLE DATA_FLOW;

INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Orders', '2010-01-01 00:00:00.000', '2010-01-01 00:00:00.000');
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Products', '2010-01-01 00:00:00.000', '2010-01-01 00:00:00.000');
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Dim_Date', '2010-01-01 00:00:00.000', '2010-01-01 00:00:00.000');
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Dim_Location', '2010-01-01 00:00:00.000', '2010-01-01 00:00:00.000');
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Dim_Customer', '2010-01-01 00:00:00.000', '2010-01-01 00:00:00.000');
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Dim_Product', '2010-01-01 00:00:00.000', '2010-01-01 00:00:00.000');
INSERT INTO DATA_FLOW (TABLE_NAME, LSET, CET) VALUES ('Fact_Order', '2010-01-01 00:00:00.000', '2010-01-01 00:00:00.000');
GO